{"mappings":"AAAA,MAEMA,EAAO,CACXC,WAAYC,SAASC,cAAc,cACnCC,OAAQF,SAASC,cAAc,WAC/BE,OAAQH,SAASC,cAAc,YAC/BG,cAAeJ,SAASC,cAAc,mBACtCI,iBAAkBL,SAASC,cAAc,0BAG3CH,EAAKI,OAAOI,iBAAiB,SAE7B,SAAsBC,GAEpBT,EAAKM,cAAcI,mBAAmB,YADvB,qC,IAIjBV,EAAKC,WAAWO,iBAAiB,UAEjC,SAAqBG,GACnBA,EAAEC,iBAEF,MACMC,EADO,IAAIC,SAASH,EAAEI,eACJC,OAAO,YAgBjCC,eAA8BJ,GAC5B,MAAMK,EAAYL,EAAWM,KAAIF,MAAMG,IACrC,MAAMC,QAAiBC,MAAM,uCAAeF,KAC5C,IAAKC,EAASE,GACZ,MAAM,IAAIC,MAAM,IAElB,OAAOH,EAASI,MAAM,IAElBC,QAAaC,QAAQC,WAAWV,GAKtC,OAJmBQ,EAChBG,QAAO,EAACC,OAAEA,KAAwB,cAAXA,IACvBC,SAAQ,EAACC,MAAEA,KAAYA,G,EAtB1BC,CAJwBpB,EACrBgB,QAAOT,GAAWA,IAClBD,KAAIC,GAAWA,EAAQc,QAAO,KAAO,OAGrCC,MAAKlB,MAAMI,IACV,MAAMe,EAAWf,EAASF,KAAI,EAACkB,QAAEA,KAAcA,EAAQ,KACjDC,QAwBZrB,eAA0BsB,GACxB,MAAMC,EAAW,+BACXC,EAAU,kCAEVvB,EAAYqB,EAAIpB,KAAIF,MAAMyB,IAC9B,MAAMC,EAAS,IAAIC,gBAAgB,CACjCC,IAAKJ,EACLK,EAAGJ,EACHK,KAAM,OAEF1B,QAAiBC,MAAM,GAAGkB,mBAA0BG,KAC1D,IAAKtB,EAASE,GACZ,MAAM,IAAIC,MAAMH,EAAS2B,YAG3B,OAAO3B,EAASI,MAAM,IAElBC,QAAaC,QAAQC,WAAWV,GAKtC,OAJsBQ,EACnBG,QAAO,EAACC,OAAEA,KAAwB,cAAXA,IACvBX,KAAI,EAACa,MAAEA,KAAYA,G,CA5CWiB,CAAWb,IAiD9C,SAA+Bc,GAC7B,MAAMC,EAASD,EACZ/B,KACC,EACEiC,SAASC,OACPA,EAAMC,SACNA,EACAC,WAAWC,KAAEA,EAAIC,KAAEA,IAErBC,UAAUC,KAAEA,EAAIvC,QAAEA,MACd,gFACqCuC,0DACAvC,+FAEDoC,0DACHC,iGAEeJ,4EACAC,sBAGvDM,KAAK,IAED5D,EAAKO,iBAAiBG,mBAAmB,YAAayC,E,CAtEzDU,CAAsBvB,EAAe,IAEtCwB,OAAMC,GAAOC,QAAQC,IAAIF,KACzBG,SAAQvD,GAAKX,EAAKC,WAAWkE,S","sources":["src/index.js"],"sourcesContent":["const BASE_URL = 'https://restcountries.com/v3.1/name';\n\nconst refs = {\n  searchForm: document.querySelector('.js-search'),\n  addBtn: document.querySelector('.js-add'),\n  listEl: document.querySelector('.js-list'),\n  formContainer: document.querySelector('.form-container'),\n  weatherContainer: document.querySelector('.js-weather-container'),\n};\n\nrefs.addBtn.addEventListener('click', onCountryAdd);\n\nfunction onCountryAdd(evt) {\n  const markup = `<input type=\"text\" name=\"country\">`;\n  refs.formContainer.insertAdjacentHTML('beforeend', markup);\n}\n\nrefs.searchForm.addEventListener('submit', onSearchBtn);\n\nfunction onSearchBtn(e) {\n  e.preventDefault();\n  //   console.dir(e.target);\n  const data = new FormData(e.currentTarget);\n  const arrCountry = data.getAll('country');\n  const filteredCountry = arrCountry\n    .filter(country => country)\n    .map(country => country.replace(/ /g, ''));\n\n  fetchCountries(filteredCountry)\n    .then(async responce => {\n      const capitals = responce.map(({ capital }) => capital[0]); // чому стоїть 0 це щоб брати перший елемент масиву\n      const weatherService = await getWeather(capitals);\n\n      onCreateMarkupWeather(weatherService);\n    })\n    .catch(err => console.log(err))\n    .finally(e => refs.searchForm.reset());\n}\n\nasync function fetchCountries(arrCountry) {\n  const responces = arrCountry.map(async country => {\n    const responce = await fetch(`${BASE_URL}/${country}`);\n    if (!responce.ok) {\n      throw new Error('');\n    }\n    return responce.json();\n  });\n  const data = await Promise.allSettled(responces);\n  const countryObj = data\n    .filter(({ status }) => status === 'fulfilled')\n    .flatMap(({ value }) => value);\n\n  return countryObj;\n}\n\nasync function getWeather(arr) {\n  const BASE_URL = `http://api.weatherapi.com/v1`;\n  const API_KEY = `de3d646b80f44831adc131731240809`;\n\n  const responces = arr.map(async city => {\n    const params = new URLSearchParams({\n      key: API_KEY,\n      q: city,\n      lang: 'uk',\n    });\n    const responce = await fetch(`${BASE_URL}//current.json?${params}`);\n    if (!responce.ok) {\n      throw new Error(responce.statusText);\n    }\n\n    return responce.json();\n  });\n  const data = await Promise.allSettled(responces);\n  const filerdWeather = data\n    .filter(({ status }) => status === 'fulfilled')\n    .map(({ value }) => value);\n\n  return filerdWeather;\n}\n\nfunction onCreateMarkupWeather(arrData) {\n  const markup = arrData\n    .map(\n      ({\n        current: {\n          temp_c,\n          humidity,\n          condition: { text, icon },\n        },\n        location: { name, country },\n      }) => ` <ul class=\"weather-widget\">\n      <li class=\"weather-item weather-country\">${name}</li>\n      <li class=\"weather-item weather-capital\">${country}</li>\n      <ul class=\"weather-condition\">\n        <li><p class=\"weather-condition-text\">${text}</p></li>\n        <li><img class=\"weather-icon\" src=\"${icon}\" alt=\"ICON\" /></li>\n      </ul>\n      <li class=\"weather-item weather-temp\">Current temp: ${temp_c} &deg;C</li>\n      <li class=\"weather-item weather-humidity\">Humidity: ${humidity}</li>\n    </ul>`\n    )\n    .join('');\n\n  return refs.weatherContainer.insertAdjacentHTML('beforeend', markup);\n}\n"],"names":["$1f0dc3b9307be026$var$refs","searchForm","document","querySelector","addBtn","listEl","formContainer","weatherContainer","addEventListener","evt","insertAdjacentHTML","e","preventDefault","arrCountry","FormData","currentTarget","getAll","async","responces","map","country","responce","fetch","ok","Error","json","data","Promise","allSettled","filter","status","flatMap","value","$1f0dc3b9307be026$var$fetchCountries","replace","then","capitals","capital","weatherService","arr","BASE_URL1","API_KEY","city","params","URLSearchParams","key","q","lang","statusText","$1f0dc3b9307be026$var$getWeather","arrData","markup","current","temp_c","humidity","condition","text","icon","location","name","join","$1f0dc3b9307be026$var$onCreateMarkupWeather","catch","err","console","log","finally","reset"],"version":3,"file":"index.c8bd46d9.js.map"}